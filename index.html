<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kraepelin Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .question {
            font-size: 20px;
            margin-bottom: 10px;
        }
        .timer {
            font-size: 16px;
            margin-bottom: 20px;
        }
        .submit-btn {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Kraepelin Test</h1>
    <form id="kraepelinTestForm">
        <label for="name">Nama:</label><br>
        <input type="text" id="name" required><br><br>

        <label for="birthyear">Tahun Lahir:</label><br>
        <input type="number" id="birthyear" required><br><br>

        <label for="education">Pendidikan Terakhir:</label><br>
        <select id="education">
            <option value="SMA">SMA</option>
            <option value="D3">D3</option>
            <option value="S1">S1</option>
            <option value="S2">S2</option>
            <option value="S3">S3</option>
        </select><br><br>

        <div id="questions">
            <!-- Questions will be injected here -->
        </div>

        <div id="timer" class="timer">
            Waktu: <span id="timeRemaining">30</span> detik
        </div>

        <button class="submit-btn" type="submit">Submit</button>
    </form>

    <script>
        const questions = [
            "Soal 1", "Soal 2", "Soal 3", "Soal 4", "Soal 5", "Soal 6", "Soal 7", "Soal 8", "Soal 9", "Soal 10",
            "Soal 11", "Soal 12", "Soal 13", "Soal 14", "Soal 15", "Soal 16", "Soal 17", "Soal 18", "Soal 19", "Soal 20",
            "Soal 21", "Soal 22", "Soal 23", "Soal 24", "Soal 25", "Soal 26", "Soal 27"
        ];

        let currentQuestionIndex = 0;
        let timer;

        function displayQuestion() {
            const questionContainer = document.getElementById('questions');
            questionContainer.innerHTML = `
                <div class="question">
                    ${questions[currentQuestionIndex]}
                </div>
                <input type="text" id="answer" autofocus>
            `;
        }

        function startTimer() {
            let timeRemaining = 30;
            document.getElementById('timeRemaining').textContent = timeRemaining;

            timer = setInterval(function() {
                timeRemaining--;
                document.getElementById('timeRemaining').textContent = timeRemaining;

                if (timeRemaining <= 0) {
                    clearInterval(timer);
                    moveToNextQuestion();
                }
            }, 1000);
        }

        function moveToNextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                displayQuestion();
                startTimer();
            } else {
                alert("Tes selesai!");
                saveResults();
            }
        }

        function saveResults() {
            const name = document.getElementById('name').value;
            const birthyear = document.getElementById('birthyear').value;
            const education = document.getElementById('education').value;
            const answers = [];

            const answerElements = document.querySelectorAll('input[type="text"]');
            answerElements.forEach((input) => {
                answers.push(input.value);
            });

            const data = {
                name: name,
                birthyear: birthyear,
                education: education,
                answers: answers
            };

            fetch("https://script.google.com/macros/s/AKfycbxruV3FTAh2l9W-ID5Krsgn-cbPAx8K13HI4gPARJtAvdGhlGTQveVonk2eAMTkbO0AUA/exec", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => alert("Hasil telah terkirim!"))
            .catch(error => alert("Terjadi kesalahan saat mengirim hasil."));
        }

        document.getElementById('kraepelinTestForm').addEventListener('submit', function(event) {
            event.preventDefault();
            saveResults();
        });

        document.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                moveToNextQuestion();
            }
        });

        displayQuestion();
        startTimer();
    </script>
</body>
</html>
